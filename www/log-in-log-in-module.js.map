{"version":3,"sources":["webpack:///./src/app/log-in/log-in.module.ts","webpack:///./src/app/log-in/login-routing.module.ts","webpack:///./src/app/log-in/login/invalid-login-error-dialog.html","webpack:///./src/app/log-in/login/login.component.html","webpack:///./src/app/log-in/login/login.component.scss","webpack:///./src/app/log-in/login/login.component.ts","webpack:///./src/app/services/login.service.ts"],"names":[],"mappings":"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","file":"log-in-log-in-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { LoginComponent, InvalidLoginErrorDialog } from './login/login.component';\r\nimport { LoginRoutingModule } from './login-routing.module';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\nimport { MatIconModule, MatFormFieldModule, MatInputModule, MatButtonModule, MatToolbarModule, MatDialogModule, MatProgressBarModule } from '@angular/material';\r\nimport { MDBBootstrapModule } from 'angular-bootstrap-md';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    LoginRoutingModule,\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    MatIconModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatButtonModule,\r\n    MDBBootstrapModule.forRoot(),\r\n    MatToolbarModule,\r\n    MatDialogModule,\r\n    MatProgressBarModule\r\n    \r\n  ],\r\n  declarations: [LoginComponent,InvalidLoginErrorDialog],\r\n  entryComponents:[InvalidLoginErrorDialog]\r\n})\r\nexport class LogInModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { LoginComponent } from './login/login.component';\r\n\r\nconst routes: Routes = [\r\n  {path: '', component: LoginComponent }\r\n  \r\n];\r\n\r\n@NgModule({\r\n  imports: [CommonModule,RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class LoginRoutingModule { }\r\n","module.exports = \"<h6>Invalid Username/Password.</h6>\\r\\n<div mat-dialog-actions class=\\\"float-right\\\">\\r\\n  <button mdbBtn color=\\\"primary\\\" (click)=\\\"onOkClick()\\\" class=\\\"waves-light\\\" mdbWavesEffect>Ok</button>\\r\\n</div>\\r\\n\"","module.exports = \"<mat-toolbar color=\\\"primary\\\">\\r\\n    Registra Timbrature\\r\\n</mat-toolbar>\\r\\n\\r\\n<div class=\\\"modal-dialog\\\" role=\\\"document\\\">\\r\\n  <div class=\\\"modal-content\\\">\\r\\n    <div class=\\\"modal-header text-center\\\">\\r\\n      <h4 class=\\\"modal-title w-100 font-weight-bold\\\">Accesso 2</h4>\\r\\n    </div>\\r\\n    <form [formGroup]=\\\"loginForm\\\" (ngSubmit)=\\\"onSubmit()\\\">\\r\\n      <div class=\\\"modal-body mx-3\\\">\\r\\n        <div class=\\\" mb-2\\\">\\r\\n          <mat-form-field>\\r\\n            <input\\r\\n              matInput\\r\\n              placeholder=\\\"Nome utente\\\"\\r\\n              formControlName=\\\"username\\\"\\r\\n              autocomplete=\\\"off\\\"\\r\\n            />\\r\\n            <mat-icon matPrefix>person</mat-icon>\\r\\n          </mat-form-field>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\" mb-4\\\">\\r\\n          <mat-form-field>\\r\\n            <input\\r\\n              matInput\\r\\n              placeholder=\\\"Password\\\"\\r\\n              type=\\\"password\\\"\\r\\n              formControlName=\\\"password\\\"\\r\\n              autocomplete=\\\"off\\\"\\r\\n            />\\r\\n            <mat-icon matPrefix>lock</mat-icon>\\r\\n          </mat-form-field>\\r\\n        </div>\\r\\n      </div>\\r\\n      <mat-progress-bar mode=\\\"indeterminate\\\" *ngIf=\\\"logbtnclick\\\"></mat-progress-bar>\\r\\n      <div class=\\\"modal-footer d-flex justify-content-center\\\">\\r\\n        <button mdbBtn color=\\\"primary\\\" class=\\\"waves-light\\\" mdbWavesEffect>\\r\\n            Accesso\\r\\n        </button>\\r\\n      </div>\\r\\n    </form>\\r\\n  </div>\\r\\n</div>\\r\\n\"","module.exports = \".mat-toolbar {\\n  position: -webkit-sticky;\\n  position: sticky;\\n  top: 0;\\n  height: 60px;\\n  z-index: 99; }\\n\\n.mat-form-field {\\n  width: 100%; }\\n\\n.modal-dialog {\\n  margin-top: 5% !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9nLWluL2xvZ2luL0Y6XFxBbGxpYW56LVByb2plY3RzXFxHSVRcXGFuZ3VsYXItdGVtcGxhdGUvc3JjXFxhcHBcXGxvZy1pblxcbG9naW5cXGxvZ2luLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0Usd0JBQWdCO0VBQWhCLGdCQUFnQjtFQUNoQixNQUFNO0VBQ04sWUFBWTtFQUNaLFdBQVcsRUFBQTs7QUFHYjtFQUNFLFdBQVcsRUFBQTs7QUFHYjtFQUNBLHlCQUF5QixFQUFBIiwiZmlsZSI6InNyYy9hcHAvbG9nLWluL2xvZ2luL2xvZ2luLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1hdC10b29sYmFyIHtcclxuICBwb3NpdGlvbjogc3RpY2t5O1xyXG4gIHRvcDogMDtcclxuICBoZWlnaHQ6IDYwcHg7XHJcbiAgei1pbmRleDogOTk7XHJcbn1cclxuXHJcbi5tYXQtZm9ybS1maWVsZCB7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5tb2RhbC1kaWFsb2d7XHJcbm1hcmdpbi10b3A6IDUlICFpbXBvcnRhbnQ7XHJcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { flatMap } from 'rxjs/operators';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { LoginService } from 'src/app/services/login.service';\r\nimport { CookieService } from 'ngx-cookie-service';\r\nimport { MatDialog, MatDialogRef } from '@angular/material';\r\ndeclare var device;\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.scss']\r\n})\r\nexport class LoginComponent implements OnInit {\r\n  loginForm: FormGroup;\r\n  subscriptions: Subscription[] = [];\r\n\r\n  logbtnclick = false;\r\n\r\n  constructor(\r\n    private formBuilder: FormBuilder,\r\n    private router: Router,\r\n    private loginService: LoginService,\r\n    private cookieService: CookieService,\r\n    public dialog: MatDialog) {\r\n    this.loginForm = this.formBuilder.group({\r\n      username: ['', Validators.required],\r\n      password: ['', Validators.required]\r\n    });\r\n  }\r\n  ngOnInit() {\r\n    // document.addEventListener(\"deviceready\", function() {\r\n    //   alert(device.platform);\r\n    //   }, false);\r\n   }\r\n  onSubmit() {\r\n    if (this.loginForm.invalid) {\r\n      return;\r\n    }\r\n\r\n    const subscription1: Subscription = this.loginService\r\n      .getToken(this.loginForm.value)\r\n      .pipe(\r\n        flatMap((res: any) => {\r\n          // console.log(res);\r\n\r\n          this.cookieService.set(\r\n            'at',\r\n            res.access_token,\r\n            null,\r\n            '/',\r\n            null,\r\n            false\r\n          );\r\n          return this.loginService.getUserByUname();\r\n        })\r\n      )\r\n      .subscribe((res: any) => {\r\n        if (res != null) {\r\n          this.cookieService.set('UName', res.username, null, '/', null, false);\r\n          this.cookieService.set('type', res.role.name, null, '/', null, false);\r\n          this.cookieService.set('id', res.id, null, '/', null, false);\r\n      //    this.cookieService.set('lng', 'eng', null, '/', null, false);\r\n          if (res.role.name === 'ROLE_ADMIN') {\r\n            this.router.navigate(['./adminstampingview']);\r\n          } else { this.router.navigate(['./stampingview']); }\r\n        }\r\n      },\r\n        // tslint:disable-next-line: no-use-before-declare\r\n        () => { this.dialog.open(InvalidLoginErrorDialog); });\r\n\r\n    this.subscriptions.push(subscription1);\r\n  }\r\n\r\n  // tslint:disable-next-line: use-life-cycle-interface\r\n  ngOnDestroy(): void {\r\n    this.subscriptions.forEach(element => {\r\n      element.unsubscribe();\r\n    });\r\n  }\r\n}\r\n\r\n@Component({\r\n  // tslint:disable-next-line: component-selector\r\n  selector: 'invalid-login-error-dialog',\r\n  templateUrl: 'invalid-login-error-dialog.html'\r\n})\r\n// tslint:disable-next-line: component-class-suffix\r\nexport class InvalidLoginErrorDialog {\r\n  constructor(public dialogRef: MatDialogRef<InvalidLoginErrorDialog>) { }\r\n\r\n  onOkClick() {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { HttpParams, HttpHeaders, HttpClient } from '@angular/common/http';\r\nimport { CookieService } from 'ngx-cookie-service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class LoginService {\r\n\r\n  constructor(private http: HttpClient, private cookieService: CookieService) { }\r\n\r\n  // isUser(user: any, token: string): Observable<any> {\r\n\r\n\r\n  //   const body = new HttpParams()\r\n  //     .set('username', user.username)\r\n  //     .set('password', user.password)\r\n  //     .set('access_token', token);\r\n  //   return this.http.post('api/formSubmit', body.toString(),\r\n  //     {\r\n  //       headers: new HttpHeaders()\r\n  //         .set('Content-Type', 'application/x-www-form-urlencoded')\r\n  //     });\r\n  // }\r\n\r\n  getToken(user: any) {\r\n\r\n\r\n    const body = new HttpParams()\r\n      .set('grant_type', 'password')\r\n      .set('username', user.username)\r\n      .set('password', user.password);\r\n\r\n\r\n    // const body = new HttpParams()\r\n    // .set('grant_type', 'client_credentials');\r\n\r\n    return this.http.post('oauth/token', body.toString(),\r\n      {\r\n        headers: new HttpHeaders()\r\n        .set('Content-Type', 'application/x-www-form-urlencoded')\r\n        .set('Authorization', 'Basic aXN0Q2xpZW50OmlzdFNlY3JldA==')\r\n      });\r\n  }\r\n\r\n  getUserByUname() {\r\n    return this.http.get('api/owndetails', {\r\n      headers: new HttpHeaders()\r\n        .set('Authorization', 'Bearer ' + this.cookieService.get('at'))\r\n    });\r\n  }\r\n\r\n\r\n}\r\n"],"sourceRoot":""}